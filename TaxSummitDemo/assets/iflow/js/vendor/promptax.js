/*! New York State Department of Taxation & Finance External Applications
 *  @description  Iflow External Applications
 *  @version      4.2.55.REL20180514
 *  @copyright    2018 New York State Department of Taxation & Finance
 */

try{uiGlobal.externalEnv.sId="promptax"}catch(e){}var promptax=function(){var abaInput=null,abaBankNameDiv=null,abaBankNameInput=null,_priv={};return _priv._init=function(){try{_priv._getAbaNumberInit()}catch(e){uiUtil.errorHandling.jsLog.addEntry(e,arguments)}},_priv._getAbaNumberInit=function(){try{if(abaInput=document.getElementById("bankRoutingNumber"))return uiUtil.attachEvent(abaInput,"blur",_priv._getAbaNumber),abaBankNameDiv=document.getElementById("bankNameDisplay"),abaBankNameInput=document.getElementById("bankName"),!0}catch(e){uiUtil.errorHandling.jsLog.addEntry(e,arguments)}},_priv._getAbaNumber=function(){try{var settings,routingNum=uiUtil.trim(abaInput.value);routingNum.length?(settings={sUrl:"RELATIVE_PATH_TO_ENDPOINT",iTimeout:"",sMethod:"POST",oParams:"ROUTING_NUMBER="+routingNum,sSpinElemId:"bankAccountNew_block",onSuccessXtra:_priv._getAbaNumberAjaxSuccess,onError:_priv._getAbaNumberAjaxError,onTimeout:_priv._getAbaNumberAjaxError},uiMethods.ajax.execute(settings),uiMethods.buttons.mutex.disableAll()):_priv._getAbaNumberClearBankName()}catch(e){uiUtil.errorHandling.jsLog.addEntry(e,arguments)}},_priv._getAbaNumberAjaxSuccess=function(xhr,oSettings){var response=null;try{"SUCCESS"===(response=JSON.parse(xhr.responseText)).status?(abaBankNameDiv.innerHTML=response.data.BANK_NAME,abaBankNameInput.value=response.data.BANK_NAME,uiUtil.setFocus("bankAcctNumber")):/INVALID_CONTRACT|ERROR/.test(response.status)&&_priv._getAbaNumberClearBankName()}catch(e){uiUtil.errorHandling.jsLog.addEntry(e,arguments)}finally{uiMethods.buttons.mutex.enableAll(),response&&response.userMessages&&(uiMethods.iFlowMessages.oJSON=response.userMessages,uiMethods.iFlowMessages.display())}},_priv._getAbaNumberAjaxError=function(args){try{window.location.href="error.html"}catch(e){uiUtil.errorHandling.jsLog.addEntry(e,arguments)}},_priv._getAbaNumberClearBankName=function(){try{abaBankNameDiv.innerHTML="",abaBankNameInput.value=""}catch(e){uiUtil.errorHandling.jsLog.addEntry(e,arguments)}},uiUtil.attachEvent(window,"load",_priv._init),{removeBankAccount:function(itemKey){}}}();