/*! New York State Department of Taxation & Finance External Applications
 *  @description  Iflow External Applications
 *  @version      4.2.55.REL20180514
 *  @copyright    2018 New York State Department of Taxation & Finance
 */

var ptfz=function(){var townCityLastRequestedCode="",townCityDropdown=null,priv={init:function(){try{priv.getTownCityInit()}catch(e){uiUtil.errorHandling.jsLog.addEntry(e,arguments)}},getTownCityInit:function(){try{var countyDropdown=document.getElementById("code");countyDropdown&&uiUtil.attachEvent(countyDropdown,"change",priv.getTownCity),townCityDropdown=document.getElementById("select")}catch(e){uiUtil.errorHandling.jsLog.addEntry(e,arguments)}},getTownCity:function(ev){try{var element=uiUtil.getHTMLObjFromEvent(ev),countyCode="";if(element){if(!(countyCode=uiUtil.trim(element.value))||/^N/.test(countyCode)||"00"===countyCode)return!1;townCityLastRequestedCode=countyCode,uiMethods.ajax.execute({sUrl:"IFlowAjaxGatewayServlet",sMethod:"POST",oParams:"code="+countyCode+"&jadeAction=PTFZ_PLOC01_RETRIEVE_TOWN_CITY_ACTION",onSuccess:priv.getTownCityAjaxSuccess,onError:priv.getTownCityAjaxError})}}catch(e){uiUtil.errorHandling.jsLog.addEntry(e,arguments)}},getTownCityAjaxSuccess:function(xmlHTTP,settings){try{var json=JSON.parse(xmlHTTP.responseText),code=settings.oParams.substring(settings.oParams.indexOf("code=")+5,settings.oParams.indexOf("&"));return"FORWARD"===json.status&&(window.location.href=json.forwardPage),townCityLastRequestedCode!==code?!1:(priv.resetTownCityList(),json.townsCities.forEach(function(town,i){townCityDropdown.options[i]=new Option(town.name,town.code)}),json.townsCities.length)}catch(e){return uiUtil.errorHandling.jsLog.addEntry(e,arguments),-1}},getTownCityAjaxError:function(xmlHTTP,settings){try{return uiMethods.iFlowMessages.oJSON='{ "iFlowMessages": { "pageMessages": [ { "type": "error", "description": "'+settings.sErrorMessage+'" } ], "formMessages": [] } }',uiMethods.iFlowMessages.display({oFocus:"errorMessages"}),priv.resetTownCityList(!0),!0}catch(e){return uiUtil.errorHandling.jsLog.addEntry(e,arguments),!1}},resetTownCityList:function(addPlaceholder){try{for(;townCityDropdown.firstChild;)townCityDropdown.removeChild(townCityDropdown.firstChild);return addPlaceholder&&(townCityDropdown.options[0]=new Option("Select town/city","00"),townCityDropdown.options[0].setAttribute("selected","selected")),!0}catch(e){return uiUtil.errorHandling.jsLog.addEntry(e,arguments),!1}}};window.attachEvent||"function"!=typeof domready?uiUtil.attachEvent(window,"load",priv.init):domready(priv.init)}();